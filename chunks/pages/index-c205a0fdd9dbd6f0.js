(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return s(333)}])},333:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return B}});var a=s(1844);s(8987);var l=s(5784),i=s(9008),n=s.n(i),r=s(6725);let c=e=>{let{data:t}=e,[s,i]=(0,l.useState)(null),n=(0,l.useCallback)(e=>{let{bounds:t}=e;i(t)},[]);return(0,a.jsxs)("div",{style:{height:"100vh",width:"100%"},children:[(0,a.jsx)("h2",{className:"text-2xl ",children:"Locations "}),(0,a.jsx)(r.ZP,{bootstrapURLKeys:{key:"AIzaSyDwyMjzC_DNXa5yj8ZDCwC0M4594JMa98o"},defaultCenter:{lat:59.95,lng:-119.27337},defaultZoom:1,onChange:n,children:t.map((e,t)=>(0,a.jsx)(o,{lat:e.Lat,lng:e.Long,name:e.Asset_Name,reskLevel:100*e.Risk_Rating},t))})]})};function o(e){let{name:t,reskLevel:s,lat:l,lng:i}=e;return(0,a.jsxs)("div",{style:{color:s<30?"#D2222D":s>=30&&s<=80?"#FFBF00":"#238823"},children:[(0,a.jsx)("i",{className:"fas fa-map-marker-alt"}),t]})}var u=s(1120),h=s(9895),x=s(2037),d=s(6847),f=s(2302),m=s(3750),j=s(7394),g=s(8222),w=s(9613),p=s(5912),v=s(8577),y=s(275),Z=s(1886),_=s(7395),k=s(6136);let b=(0,u.Z)({root:{width:"100%"},container:{maxHeight:440},textField:{marginLeft:"10px",marginBottom:16}}),N=e=>{let{assets:t}=e,s=[{id:"name",label:"Asset Name",icon:(0,a.jsx)(v.Z,{})},{id:"lat",label:"Latitude",icon:(0,a.jsx)(y.Z,{})},{id:"long",label:"Longitude",icon:(0,a.jsx)(y.Z,{})},{id:"category",label:"Business Category",icon:(0,a.jsx)(Z.Z,{})},{id:"riskRating",label:"Risk Rating",icon:(0,a.jsx)(_.Z,{})},{id:"riskFactors",label:"Risk Factors",icon:(0,a.jsx)(_.Z,{})},{id:"year",label:"Year",icon:(0,a.jsx)(k.Z,{})}],i=b(),[n,r]=(0,l.useState)(0),[c,o]=(0,l.useState)(10),[u,N]=(0,l.useState)(""),[R,C]=(0,l.useState)(!1),L=0;(0,l.useEffect)(()=>{C(!0)},[]);let S=(e,t)=>{r(t)},E=e=>{null!=e&&(o(+e.target.value),r(0))},F=e=>{null!=e&&(N(e.target.value),r(0))},A=t.filter(e=>e.Asset_Name.toLowerCase().includes(u.toLowerCase())||e.Business_Category.toLowerCase().includes(u.toLowerCase())||e.Risk_Rating),P=c-Math.min(c,t.length-n*c);return(0,a.jsxs)("div",{style:{height:"100%",width:"100%"},children:[(0,a.jsx)("h2",{className:"text-2xl ",children:"Risk Data"}),R&&(0,a.jsxs)(h.Z,{className:i.root,children:[(0,a.jsx)(x.Z,{label:"Filter",variant:"outlined",size:"small",margin:"normal",value:u,onChange:F,classes:{root:i.textField}}),(0,a.jsx)(d.Z,{component:h.Z,children:(0,a.jsxs)(f.Z,{children:[(0,a.jsx)(m.Z,{children:(0,a.jsx)(j.Z,{children:s.map(e=>(0,a.jsxs)(g.Z,{children:[e.icon," ",e.label]},e.id))})}),(0,a.jsxs)(w.Z,{children:[A.slice(n*c,n*c+c).map(e=>(L++,(0,a.jsxs)(j.Z,{children:[(0,a.jsx)(g.Z,{children:e.Asset_Name}),(0,a.jsx)(g.Z,{children:e.Lat}),(0,a.jsx)(g.Z,{children:e.Long}),(0,a.jsx)(g.Z,{children:e.Business_Category}),(0,a.jsx)(g.Z,{children:e.Risk_Rating}),(0,a.jsx)(g.Z,{children:e.Risk_Factors}),(0,a.jsx)(g.Z,{children:e.Year})]},L))),P>0&&(0,a.jsx)(j.Z,{style:{height:53*P},children:(0,a.jsx)(g.Z,{colSpan:7})})]})]})}),(0,a.jsx)(p.Z,{rowsPerPageOptions:[5,10,25],component:"div",count:t.length,rowsPerPage:c,page:n,onPageChange:S,onRowsPerPageChange:E})]})]})};var R=s(8840),C=s.n(R),L=s(5708),S=s.n(L);let E=e=>{let{data:t}=e,[s,i]=(0,l.useState)([]),[n,r]=(0,l.useState)(""),[c,o]=(0,l.useState)(!1),[u,h]=(0,l.useState)([]);(0,l.useEffect)(()=>{i(d(t,"business")),o(!0),h(x(t))},[t]);let x=e=>Array.from(new Set(e.map(e=>e.Year))),d=(e,t)=>{let s=[];if("location"===t){let t=[...new Set(e.map(e=>e.Lat+e.Long))];t.forEach(t=>{let a={},l=[],i=e.filter(e=>e.Lat+e.Long===t);for(let e in u.forEach(e=>{a[e]=[],i.filter(t=>{t.Year===e&&a[e].push(t)})}),a){let t=a[e].reduce((e,t)=>e+parseFloat(t.Risk_Rating),0);l.push(t/a[e].length)}s.push({name:t.toString(),data:l})})}else if("asset"===t){let t=[...new Set(e.map(e=>e.Asset_Name))];t.forEach(t=>{let a={},l=[],i=e.filter(e=>e.Asset_Name===t);for(let e in u.forEach(e=>{a[e]=[],i.filter(t=>{t.Year===e&&a[e].push(t)})}),a){let t=a[e].reduce((e,t)=>e+parseFloat(t.Risk_Rating),0);l.push(t/a[e].length)}s.push({name:t,data:l})})}else if("business"===t){let t=[...new Set(e.map(e=>e.Business_Category))];t.forEach(t=>{let a={},l=[],i=e.filter(e=>e.Business_Category===t);for(let e in u.forEach(e=>{a[e]=[],i.filter(t=>{t.Year===e&&a[e].push(t)})}),a){let t=a[e].reduce((e,t)=>e+parseFloat(t.Risk_Rating),0);l.push(t/a[e].length)}s.push({name:t,data:l})})}return s},f=e=>{r(e.target.value),i(d(t,e.target.value))};return(0,a.jsx)(a.Fragment,{children:c&&(0,a.jsxs)("div",{className:"flex flex-col w-full justify-center items-center",children:[(0,a.jsx)("div",{className:"w-full justify-center items-center",children:(0,a.jsx)("select",{value:n,onChange:f,children:[{value:"",label:"Select Graph Type"},{value:"business",label:"Business"},{value:"location",label:"Location"},{value:"asset",label:"Asset"}].map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))})}),(0,a.jsx)("div",{className:"w-full justify-center items-center",children:(0,a.jsx)(S(),{highcharts:C(),options:{title:{text:"Risk Rating Over Time"},xAxis:{title:{text:"Year"},categories:u},yAxis:{title:{text:"Risk Rating"}},series:s}})})]})})},{parse:F}=s(5492),A=e=>new Promise((t,s)=>{F(e.trim(),{columns:!0},(e,a)=>{e?s(e):t(a)})});async function P(e){let t=await A(e),s=t.map(e=>{let t={};return Object.keys(e).forEach(s=>{t[s.replace(/\s+/g,"_")]=e[s]}),t});return s}let Y=()=>{let[e,t]=l.useState([]);return l.useEffect(()=>{let e=async()=>{let e=await fetch("http://localhost:3000/data/risk_data.csv"),s=await e.text(),a=await P(s),l=a.sort((e,t)=>e.Year-t.Year);t(l)};e()},[]),(0,a.jsxs)("div",{children:[(0,a.jsxs)(n(),{children:[(0,a.jsx)("title",{children:"RiskThinking"}),(0,a.jsx)("link",{rel:"icon",href:"favicon.ico"})]}),(0,a.jsx)("main",{className:"flex min-h-screen flex-col items-center justify-between p-24",children:(0,a.jsxs)("div",{className:"flex flex-col justify-center items-center ",children:[(0,a.jsx)("div",{className:"z-10 w-full max-w-5xl items-center justify-between font-mono text-sm lg:flex h-1/3",children:(0,a.jsx)(c,{data:e})}),(0,a.jsx)("div",{style:{minHeight:"100px"},className:"w-full max-w-5xl h-20 flex-shrink-0 "}),(0,a.jsx)("div",{className:"z-10 w-full max-w-5xl items-center justify-between font-mono text-sm lg:flex h-1/3",children:(0,a.jsx)(N,{assets:e})}),(0,a.jsx)("div",{style:{minHeight:"100px"},className:"w-full max-w-5xl h-20 flex-shrink-0 "}),(0,a.jsx)("div",{className:"z-10 w-full max-w-5xl items-center justify-between font-mono text-sm lg:flex h-1/3",children:(0,a.jsx)(E,{data:e})})]})})]})};var B=Y},8987:function(){}},function(e){e.O(0,[898,119,888,179],function(){return e(e.s=8312)}),_N_E=e.O()}]);